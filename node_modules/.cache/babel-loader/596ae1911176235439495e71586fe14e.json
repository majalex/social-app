{"ast":null,"code":"import _slicedToArray from\"/Users/alex/Desktop/akademia108/react/social-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./Post.css';import{useState}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Post=function Post(props){var _props$user2;var _useState=useState(props.post.likes.length),_useState2=_slicedToArray(_useState,2),likesCount=_useState2[0],setLikesCount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deleteModalVisible=_useState4[0],setDeleteModalVisible=_useState4[1];var _useState5=useState(props.post.likes.filter(function(like){var _props$user;return like.username===((_props$user=props.user)===null||_props$user===void 0?void 0:_props$user.username);}).length!==0),_useState6=_slicedToArray(_useState5,2),doesUserLiked=_useState6[0],setDoesUserLiked=_useState6[1];var deletePost=function deletePost(id){axios.post(\"https://akademia108.pl/api/social-app/post/delete\",{post_id:id}).then(function(res){console.log(res.data);props.setPosts(function(posts){return posts.filter(function(post){return post.id!==res.data.post_id;});});}).catch(function(error){console.error(error);});};var likePost=function likePost(id,isLiked){axios.post('https://akademia108.pl/api/social-app/post/'+(isLiked?'dislike':'like'),{post_id:id}).then(function(){setLikesCount(likesCount+(isLiked?-1:1));setDoesUserLiked(!isLiked);});};var unfollow=function unfollow(id){axios.post('https://akademia108.pl/api/social-app/follows/disfollow',{leader_id:id}).then(function(){props.getLatestPosts();}).catch(function(error){console.error(error);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"post\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar\",children:/*#__PURE__*/_jsx(\"img\",{src:props.post.user.avatar_url,alt:props.post.user.username})}),/*#__PURE__*/_jsxs(\"div\",{className:\"postData\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postMeta\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"author\",children:props.post.user.username}),/*#__PURE__*/_jsx(\"div\",{className:\"date\",children:props.post.created_at.substring(0,10)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postContent\",children:props.post.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"likes\",children:[((_props$user2=props.user)===null||_props$user2===void 0?void 0:_props$user2.username)===props.post.user.username&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:function onClick(){return setDeleteModalVisible(true);},children:\"Delete\"}),props.user&&props.user.username!==props.post.user.username&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:function onClick(){return unfollow(props.post.user.id);},children:\"Unfollow\"}),props.user&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:function onClick(){return likePost(props.post.id,doesUserLiked);},children:doesUserLiked?'Dislike':'Like'}),likesCount]})]}),deleteModalVisible&&/*#__PURE__*/_jsxs(\"div\",{className:\"deleteConfirmation\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Are you sure you want to delete post?\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn yes\",onClick:function onClick(){return deletePost(props.post.id);},children:\"Yes\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn no\",onClick:function onClick(){return setDeleteModalVisible(false);},children:\"No\"})]})]});};export default Post;","map":{"version":3,"names":["useState","axios","Post","props","post","likes","length","likesCount","setLikesCount","deleteModalVisible","setDeleteModalVisible","filter","like","username","user","doesUserLiked","setDoesUserLiked","deletePost","id","post_id","then","res","console","log","data","setPosts","posts","catch","error","likePost","isLiked","unfollow","leader_id","getLatestPosts","avatar_url","created_at","substring","content"],"sources":["/Users/alex/Desktop/akademia108/react/social-app/src/components/Post.js"],"sourcesContent":["import './Post.css';\nimport { useState } from \"react\";\nimport axios from 'axios';\n\nconst Post = (props) => {\n\n    const [likesCount, setLikesCount] = useState(props.post.likes.length);\n    const [deleteModalVisible, setDeleteModalVisible] = useState(false);\n    const [doesUserLiked, setDoesUserLiked] = useState(props.post.likes.filter(like => like.username === props.user?.username).length !== 0);\n\n\n    const deletePost = (id) => {\n        axios\n            .post(\"https://akademia108.pl/api/social-app/post/delete\", {\n                post_id: id,\n            })\n            .then((res) => {\n                console.log(res.data);\n                props.setPosts((posts) => {\n                    return posts.filter((post) => post.id !== res.data.post_id);\n                });\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    };\n\n    const likePost = (id, isLiked) => {\n        axios\n            .post('https://akademia108.pl/api/social-app/post/' + (isLiked ? 'dislike' : 'like'), {\n                post_id: id\n            })\n            .then(() => {\n                setLikesCount(likesCount + (isLiked ? -1 : 1));\n                setDoesUserLiked(!isLiked)\n            })\n    }\n\n    const unfollow = (id) => {\n        axios\n        .post('https://akademia108.pl/api/social-app/follows/disfollow', {\n            leader_id: id,\n        })\n        .then(() => {\n            props.getLatestPosts();\n        })\n        .catch((error) => {\n            console.error(error)\n        })\n    }\n\n    return (\n        <div className=\"post\">\n            <div className=\"avatar\">\n                <img src={props.post.user.avatar_url} alt={props.post.user.username} />\n            </div>\n            <div className=\"postData\">\n                <div className=\"postMeta\">\n                    <div className=\"author\">{props.post.user.username}</div>\n                    <div className=\"date\">{props.post.created_at.substring(0, 10)}</div>\n                </div>\n                <div className=\"postContent\">{props.post.content}</div>\n                <div className=\"likes\">\n                    {props.user?.username === props.post.user.username && (\n                        <button className='btn' onClick={() => setDeleteModalVisible(true)}>Delete\n                        </button>\n                    )}\n\n                    {props.user && props.user.username !== props.post.user.username && (<button className='btn' onClick={() => unfollow(props.post.user.id)}>Unfollow</button>)}\n\n                    {props.user && (\n                        <button className='btn' onClick={() => likePost(props.post.id, doesUserLiked)}>\n                            {doesUserLiked ? 'Dislike' : 'Like'}\n                        </button>\n                    )}\n\n\n                    {likesCount}\n                </div>\n            </div>\n\n            {deleteModalVisible && (\n                <div className=\"deleteConfirmation\">\n                    <h3>Are you sure you want to delete post?</h3>\n                    <button className='btn yes' onClick={() => deletePost(props.post.id)}>Yes</button>\n                    <button className='btn no' onClick={() => setDeleteModalVisible(false)}>No</button>\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default Post;"],"mappings":"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"},"metadata":{},"sourceType":"module"}